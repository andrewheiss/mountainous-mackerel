{
  "hash": "1558cf518019fb4d577c386d9cb5bb4b",
  "result": {
    "markdown": "---\ntitle: \"H<sub>2</sub>: Derogations and human rights\"\nformat:\n  html:\n    code-fold: true\n---\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(targets)\nlibrary(broom)\nlibrary(modelsummary)\nlibrary(kableExtra)\nlibrary(brms)\nlibrary(marginaleffects)\nlibrary(tidybayes)\nlibrary(ggdist)\nlibrary(bayesplot)\nlibrary(patchwork)\nlibrary(colorspace)\nlibrary(scales)\n\n# Bayes stuff\nBAYES_SEED <- 1234\noptions(mc.cores = 4,\n        brms.backend = \"cmdstanr\")\n\n# Generated via random.org\nset.seed(2385)\n\ntar_config_set(store = here::here('_targets'),\n               script = here::here('_targets.R'))\n\n# Load targets \n# Final data\ntar_load(daily_panel)\ntar_load(weekly_panel)\ntar_load(year_week_lookup)\n\n# Models\ntar_load(m_human_rights)\ntar_load(human_rights_plot_data)\ntar_load(models_tbl_human_rights)\n\n# Plotting functions\ninvisible(list2env(tar_read(graphic_functions), .GlobalEnv))\ninvisible(list2env(tar_read(diagnostic_functions), .GlobalEnv))\ninvisible(list2env(tar_read(modelsummary_functions), .GlobalEnv))\n\n# Tell bayesplot to use the Lakota palette for things like pp_check()\nbayesplot::color_scheme_set(clrs[c(1, 2, 4, 5, 7, 8)])\n\nweekly_panel <- weekly_panel %>% \n  mutate(across(c(new_cases, new_deaths, cumulative_cases, cumulative_deaths),\n                list(z = ~as.numeric(scale(.)))))\n```\n:::\n\n\n\n# Model and priors\n\n## Official formal model\n\n$$\n\\begin{aligned}\n\\text{COVID policy}_{i, t} \\sim&\\ \\operatorname{Bernoulli}(\\pi_{i, t}) \\\\[0.75em]\n\\operatorname{logit}(\\pi_{i, t}) =&\\ \\alpha_{\\text{region} [i]} + \\beta_1\\ \\text{Derogation in effect}_{i}\\ + \\\\\n&\\ \\beta_2\\ \\text{New cases}_{i}\\ + \\beta_3\\ \\text{Cumulative cases}_{i}\\ + \\\\\n&\\ \\beta_4\\ \\text{New deaths}_{i}\\ + \\beta_5\\ \\text{Cumulative deaths}_{i}\\ + \\\\\n&\\ \\beta_6\\ \\text{Past ICCPR derogation}_{i}\\ + \\beta_7\\ \\text{Past ICCPR action}_{i}\\ + \\\\\n&\\ \\beta_8\\ \\text{Rule of law index}_{i}\\ + \\beta_9\\ \\text{Civil liberties index}_{i}\\ + \\\\\n&\\ \\beta_{10}\\ \\text{Core civil society index}_{i}\\ + \\beta_{11}\\ \\text{Week number}_{i} \\\\\n\\alpha_j \\sim&\\ \\mathcal{N}(\\bar{\\alpha}, \\sigma_\\alpha) \\text{, for } j \\text{ in } 1 \\dots J \\\\[0.75em]\n\\bar{\\alpha} \\sim&\\ \\operatorname{Student t}(\\nu = 1, \\mu = 0, \\sigma = 3) \\\\\n\\beta_{1 \\dots 11} \\sim&\\ \\operatorname{Student t}(\\nu = 1, \\mu = 0, \\sigma = 3) \\\\\n\\sigma_a \\sim&\\ \\operatorname{Cauchy}(x = 0, \\gamma = 1) \\text{, lower bound} = 0\n\\end{aligned}\n$$\n\n## Priors\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np1 <- ggplot() +\n  stat_function(geom = \"area\", \n                fun = ~extraDistr::dlst(., df = 1, mu = 0, sigma = 3), \n                fill = clrs[2]) +\n  xlim(c(-20, 20)) +\n  annotate(geom = \"label\", x = 0, y = 0.02, label = \"Student t(1, 0, 3)\") +\n  labs(x = \"α and βs\") +\n  theme_pandem(prior = TRUE)\n\np2 <- ggplot() +\n  stat_function(geom = \"area\", \n                fun = ~dcauchy(., 0, 1), \n                fill = clrs[4]) +\n  xlim(c(0, 10)) +\n  annotate(geom = \"label\", x = 5, y = 0.063, label = \"Cauchy(0, 1)\") +\n  labs(x = \"σ\") +\n  theme_pandem(prior = TRUE)\n\np1 | p2\n```\n\n::: {.cell-output-display}\n![](analysis_human-rights_files/figure-html/unnamed-chunk-1-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\n## Prior simulation\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"show\"}\nologit_priors <- c(prior(student_t(1, 0, 3), class = Intercept),\n                   prior(student_t(1, 0, 3), class = b),\n                   prior(cauchy(0, 1), class = sd, lb = 0))\n\nmodel_human_rights_prior_only <- brm(\n  bf(pandem_nolimit ~ derogation_ineffect + \n       new_cases_z + cumulative_cases_z + \n       new_deaths_z + cumulative_deaths_z + \n       prior_iccpr_derogations + prior_iccpr_other_action +\n       v2x_rule + v2x_civlib + v2xcs_ccsi +\n       year_week_num + (1 | country_name)), \n  data = weekly_panel,\n  family = \"cumulative\",\n  prior = ologit_priors,\n  sample_prior = \"only\",\n  chains = 4, seed = BAYES_SEED, iter = 5000, refresh = 0,\n  threads = threading(2)  # Two CPUs per chain to speed things up\n)\n## Start sampling\n## Running MCMC with 4 parallel chains, with 2 thread(s) per chain...\n## \n## Chain 1 finished in 1.6 seconds.\n## Chain 2 finished in 1.9 seconds.\n## Chain 4 finished in 3.5 seconds.\n## Chain 3 finished in 7.8 seconds.\n## \n## All 4 chains finished successfully.\n## Mean chain execution time: 3.7 seconds.\n## Total execution time: 7.9 seconds.\nmodel_human_rights_prior_only\n## Warning: Parts of the model have not converged (some Rhats are > 1.05). Be careful when analysing the results! We\n## recommend running more iterations and/or setting stronger priors.\n##  Family: cumulative \n##   Links: mu = logit; disc = identity \n## Formula: pandem_nolimit ~ derogation_ineffect + new_cases_z + cumulative_cases_z + new_deaths_z + cumulative_deaths_z + prior_iccpr_derogations + prior_iccpr_other_action + v2x_rule + v2x_civlib + v2xcs_ccsi + year_week_num + (1 | country_name) \n##    Data: weekly_panel (Number of observations: 9591) \n##   Draws: 4 chains, each with iter = 5000; warmup = 2500; thin = 1;\n##          total post-warmup draws = 10000\n## \n## Group-Level Effects: \n## ~country_name (Number of levels: 139) \n##               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\n## sd(Intercept)     9.21    401.69     0.04    26.70 1.00    11322     5514\n## \n## Population-Level Effects: \n##                              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\n## Intercept[1]                    -4.47    899.82 -1435.28  1427.91 1.01     4198     1335\n## Intercept[2]                    35.66   1953.60 -1431.40  1545.34 1.01     4231     1371\n## derogation_ineffect              3.25     52.64   -37.46    46.31 1.00     2399      876\n## new_cases_z                      4.61     46.47   -33.23    61.62 1.01     1008      425\n## cumulative_cases_z              82.04    307.76   -44.62  1321.16 1.11       29       13\n## new_deaths_z                    -2.58     31.66   -41.65    29.09 1.01     1190      383\n## cumulative_deaths_z              0.16     40.38   -41.39    35.78 1.00     4227     1191\n## prior_iccpr_derogationsTRUE     -0.61     31.07   -33.36    33.18 1.00     3076     1070\n## prior_iccpr_other_actionTRUE    -4.90     46.13   -69.96    35.31 1.01      553      161\n## v2x_rule                         0.21     16.79   -25.91    30.00 1.00     4085     1711\n## v2x_civlib                       0.73     14.18   -24.48    33.61 1.00     3640     1700\n## v2xcs_ccsi                      -1.10     25.21   -34.50    28.82 1.00     2174      855\n## year_week_num                    0.10     25.71   -40.80    41.16 1.01     4683     1286\n## \n## Family Specific Parameters: \n##      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\n## disc     1.00      0.00     1.00     1.00   NA       NA       NA\n## \n## Draws were sampled using sample(hmc). For each parameter, Bulk_ESS\n## and Tail_ESS are effective sample size measures, and Rhat is the potential\n## scale reduction factor on split chains (at convergence, Rhat = 1).\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndatagrid(model = model_human_rights_prior_only,\n         year_week_num = 1:69,\n         derogation_ineffect = 0:1) %>% \n  add_epred_draws(model_human_rights_prior_only, ndraws = 100) %>% \n  left_join(year_week_lookup, by = \"year_week_num\") %>% \n  mutate(derogation_ineffect = factor(derogation_ineffect, \n                                      levels = 0:1,\n                                      labels = c(\"No\", \"Yes\"),\n                                      ordered = TRUE)) %>% \n  ggplot(aes(x = year_week_day, y = .epred, color = .category)) +\n  geom_line(aes(group = paste(.draw, .category, derogation_ineffect)), alpha = 0.5, linewidth = 0.5) +\n  scale_color_manual(values = c(clrs[c(2, 4, 6)])) +\n  scale_x_date(date_breaks = \"2 months\", date_labels = \"%b\\n%Y\") +\n  scale_y_continuous(labels = label_percent()) +\n  labs(x = NULL, y = \"Predicted probability\", \n       color = \"Severity\",\n       title = \"No Time Limit Measures (priors only)\") +\n  theme_pandem()\n```\n\n::: {.cell-output-display}\n![](analysis_human-rights_files/figure-html/unnamed-chunk-3-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\n# Posterior\n\n\n::: {#tbl-human-rights .cell layout-align=\"center\" hash='analysis_human-rights_cache/html/tbl-human-rights_f1caddf3310e3df6d47340a8f09746c4'}\n\n```{.r .cell-code}\nnotes <- c(\n  \"Estimates are median posterior log odds from ordered logistic and binary logistic regression models; 95% credible intervals (highest density posterior interval, or HDPI) in brackets.\", \n  \"Total \\\\(R^2\\\\) considers the variance of both population and group effects;\", \n  \"marginal \\\\(R^2\\\\) only takes population effects into account.\"\n)\n\nmodelsummary(models_tbl_human_rights,\n             estimate = \"{estimate}\",\n             statistic = \"[{conf.low}, {conf.high}]\",\n             coef_map = coef_map,\n             gof_map = gof_map,\n             output = \"kableExtra\",\n             fmt =  list(estimate = 2, conf.low = 2, conf.high = 2)) %>% \n  kable_styling(htmltable_class = \"table-sm light-border\") %>% \n  footnote(general = notes, footnote_as_chunk = TRUE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-sm light-border\" style=\"width: auto !important; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;border-bottom: 0;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:center;\"> Discriminatory Policy </th>\n   <th style=\"text-align:center;\"> Non-Derogable Rights </th>\n   <th style=\"text-align:center;\"> No Time Limit Measures </th>\n   <th style=\"text-align:center;\"> Abusive Enforcement </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Derogation in effect </td>\n   <td style=\"text-align:center;\"> −0.20 </td>\n   <td style=\"text-align:center;\"> −0.32 </td>\n   <td style=\"text-align:center;\"> −1.84 </td>\n   <td style=\"text-align:center;\"> 0.22 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [−0.63, 0.19] </td>\n   <td style=\"text-align:center;\"> [−0.80, 0.18] </td>\n   <td style=\"text-align:center;\"> [−2.17, −1.48] </td>\n   <td style=\"text-align:center;\"> [0.04, 0.41] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> New cases (standardized) </td>\n   <td style=\"text-align:center;\"> 0.04 </td>\n   <td style=\"text-align:center;\"> 0.003 </td>\n   <td style=\"text-align:center;\"> −0.13 </td>\n   <td style=\"text-align:center;\"> 0.03 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [−0.05, 0.13] </td>\n   <td style=\"text-align:center;\"> [−0.30, 0.25] </td>\n   <td style=\"text-align:center;\"> [−0.32, 0.04] </td>\n   <td style=\"text-align:center;\"> [−0.04, 0.11] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Cumulative cases (standardized) </td>\n   <td style=\"text-align:center;\"> −0.05 </td>\n   <td style=\"text-align:center;\"> 0.21 </td>\n   <td style=\"text-align:center;\"> −0.45 </td>\n   <td style=\"text-align:center;\"> 0.23 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [−0.23, 0.14] </td>\n   <td style=\"text-align:center;\"> [−0.22, 0.59] </td>\n   <td style=\"text-align:center;\"> [−0.68, −0.24] </td>\n   <td style=\"text-align:center;\"> [0.11, 0.36] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> New deaths (standardized) </td>\n   <td style=\"text-align:center;\"> −0.05 </td>\n   <td style=\"text-align:center;\"> −0.13 </td>\n   <td style=\"text-align:center;\"> 0.06 </td>\n   <td style=\"text-align:center;\"> 0.08 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [−0.17, 0.07] </td>\n   <td style=\"text-align:center;\"> [−0.40, 0.09] </td>\n   <td style=\"text-align:center;\"> [−0.06, 0.18] </td>\n   <td style=\"text-align:center;\"> [−0.008, 0.16] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Cumulative deaths (standardized) </td>\n   <td style=\"text-align:center;\"> 0.16 </td>\n   <td style=\"text-align:center;\"> −0.40 </td>\n   <td style=\"text-align:center;\"> 0.28 </td>\n   <td style=\"text-align:center;\"> −0.22 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [−0.06, 0.36] </td>\n   <td style=\"text-align:center;\"> [−0.78, −0.02] </td>\n   <td style=\"text-align:center;\"> [0.12, 0.44] </td>\n   <td style=\"text-align:center;\"> [−0.35, −0.09] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Past ICCPR derogation </td>\n   <td style=\"text-align:center;\"> 0.94 </td>\n   <td style=\"text-align:center;\"> 0.24 </td>\n   <td style=\"text-align:center;\"> 0.08 </td>\n   <td style=\"text-align:center;\"> 0.38 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [0.78, 1.10] </td>\n   <td style=\"text-align:center;\"> [0.003, 0.47] </td>\n   <td style=\"text-align:center;\"> [−0.05, 0.21] </td>\n   <td style=\"text-align:center;\"> [0.26, 0.50] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Past ICCPR action </td>\n   <td style=\"text-align:center;\"> 0.28 </td>\n   <td style=\"text-align:center;\"> 1.48 </td>\n   <td style=\"text-align:center;\"> −0.52 </td>\n   <td style=\"text-align:center;\"> 0.07 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [0.13, 0.44] </td>\n   <td style=\"text-align:center;\"> [1.30, 1.68] </td>\n   <td style=\"text-align:center;\"> [−0.65, −0.40] </td>\n   <td style=\"text-align:center;\"> [−0.04, 0.19] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Rule of law </td>\n   <td style=\"text-align:center;\"> 0.99 </td>\n   <td style=\"text-align:center;\"> 1.30 </td>\n   <td style=\"text-align:center;\"> 0.87 </td>\n   <td style=\"text-align:center;\"> −0.48 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [0.53, 1.42] </td>\n   <td style=\"text-align:center;\"> [0.71, 1.89] </td>\n   <td style=\"text-align:center;\"> [0.59, 1.15] </td>\n   <td style=\"text-align:center;\"> [−0.76, −0.20] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Civil liberties </td>\n   <td style=\"text-align:center;\"> 1.60 </td>\n   <td style=\"text-align:center;\"> −5.47 </td>\n   <td style=\"text-align:center;\"> −1.99 </td>\n   <td style=\"text-align:center;\"> 0.07 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [0.75, 2.42] </td>\n   <td style=\"text-align:center;\"> [−6.60, −4.33] </td>\n   <td style=\"text-align:center;\"> [−2.62, −1.40] </td>\n   <td style=\"text-align:center;\"> [−0.49, 0.69] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Core civil society index </td>\n   <td style=\"text-align:center;\"> −2.61 </td>\n   <td style=\"text-align:center;\"> 1.57 </td>\n   <td style=\"text-align:center;\"> 0.06 </td>\n   <td style=\"text-align:center;\"> −0.47 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [−3.11, −2.04] </td>\n   <td style=\"text-align:center;\"> [0.83, 2.28] </td>\n   <td style=\"text-align:center;\"> [−0.37, 0.48] </td>\n   <td style=\"text-align:center;\"> [−0.89, −0.08] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Constant </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\"> −1.17 </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\"> [−2.07, −0.17] </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Cut 1 </td>\n   <td style=\"text-align:center;\"> 1.43 </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\"> 0.43 </td>\n   <td style=\"text-align:center;\"> −0.41 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [0.07, 2.64] </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\"> [−0.59, 1.39] </td>\n   <td style=\"text-align:center;\"> [−1.06, 0.17] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Cut 2 </td>\n   <td style=\"text-align:center;\"> 2.18 </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\"> 0.49 </td>\n   <td style=\"text-align:center;\"> 0.60 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [0.73, 3.30] </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\"> [−0.52, 1.45] </td>\n   <td style=\"text-align:center;\"> [−0.04, 1.19] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Cut 3 </td>\n   <td style=\"text-align:center;\"> 2.38 </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\"> 2.02 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [0.94, 3.50] </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\">  </td>\n   <td style=\"text-align:center;\"> [1.41, 2.63] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Year-week </td>\n   <td style=\"text-align:center;\"> −0.01 </td>\n   <td style=\"text-align:center;\"> −0.01 </td>\n   <td style=\"text-align:center;\"> 0.002 </td>\n   <td style=\"text-align:center;\"> −0.03 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> [−0.02, −0.01] </td>\n   <td style=\"text-align:center;\"> [−0.01, −0.005] </td>\n   <td style=\"text-align:center;\"> [−0.0002, 0.005] </td>\n   <td style=\"text-align:center;\"> [−0.03, −0.03] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Region random effects σ </td>\n   <td style=\"text-align:center;\"> 1.38 </td>\n   <td style=\"text-align:center;\"> 0.96 </td>\n   <td style=\"text-align:center;\"> 1.13 </td>\n   <td style=\"text-align:center;\"> 0.63 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;box-shadow: 0px 1px\">  </td>\n   <td style=\"text-align:center;box-shadow: 0px 1px\"> [0.71, 2.65] </td>\n   <td style=\"text-align:center;box-shadow: 0px 1px\"> [0.48, 1.80] </td>\n   <td style=\"text-align:center;box-shadow: 0px 1px\"> [0.57, 2.14] </td>\n   <td style=\"text-align:center;box-shadow: 0px 1px\"> [0.31, 1.18] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> N </td>\n   <td style=\"text-align:center;\"> 9591 </td>\n   <td style=\"text-align:center;\"> 9591 </td>\n   <td style=\"text-align:center;\"> 9591 </td>\n   <td style=\"text-align:center;\"> 9591 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> \\(R^2\\) (total) </td>\n   <td style=\"text-align:center;\"> 0.15 </td>\n   <td style=\"text-align:center;\"> 0.12 </td>\n   <td style=\"text-align:center;\"> 0.07 </td>\n   <td style=\"text-align:center;\"> 0.13 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> \\(R^2\\) (marginal) </td>\n   <td style=\"text-align:center;\"> 0.07 </td>\n   <td style=\"text-align:center;\"> 0.09 </td>\n   <td style=\"text-align:center;\"> 0.04 </td>\n   <td style=\"text-align:center;\"> 0.07 </td>\n  </tr>\n</tbody>\n<tfoot><tr><td style=\"padding: 0; \" colspan=\"100%\">\n<span style=\"font-style: italic;\">Note: </span> <sup></sup> Estimates are median posterior log odds from ordered logistic and binary logistic regression models; 95% credible intervals (highest density posterior interval, or HDPI) in brackets. <sup></sup> Total \\(R^2\\) considers the variance of both population and group effects; <sup></sup> marginal \\(R^2\\) only takes population effects into account.</td></tr></tfoot>\n</table>\n\n`````\n:::\n:::\n\n\n\n# Model evaluation\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nparams_to_show <- c(\"b_derogation_ineffect\", \"b_year_week_num\", \n                    \"b_v2xcs_ccsi\", \"sd_who_region__Intercept\")\n```\n:::\n\n\n::: {.panel-tabset}\n\n### Discriminatory Policy\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nplot_trace(m_human_rights$model[[1]], params_to_show)\n```\n\n::: {.cell-output-display}\n![](analysis_human-rights_files/figure-html/unnamed-chunk-5-1.png){fig-align='center' width=80%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nplot_trank(m_human_rights$model[[1]], params_to_show)\n```\n\n::: {.cell-output-display}\n![](analysis_human-rights_files/figure-html/unnamed-chunk-6-1.png){fig-align='center' width=80%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nplot_pp(m_human_rights$model[[1]])\n```\n\n::: {.cell-output-display}\n![](analysis_human-rights_files/figure-html/unnamed-chunk-7-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n### Non-Derogable Rights\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nplot_trace(m_human_rights$model[[2]], params_to_show)\n```\n\n::: {.cell-output-display}\n![](analysis_human-rights_files/figure-html/unnamed-chunk-8-1.png){fig-align='center' width=80%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nplot_trank(m_human_rights$model[[2]], params_to_show)\n```\n\n::: {.cell-output-display}\n![](analysis_human-rights_files/figure-html/unnamed-chunk-9-1.png){fig-align='center' width=80%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nplot_pp(m_human_rights$model[[2]])\n```\n\n::: {.cell-output-display}\n![](analysis_human-rights_files/figure-html/unnamed-chunk-10-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n### No Time Limit Measures\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nplot_trace(m_human_rights$model[[3]], params_to_show)\n```\n\n::: {.cell-output-display}\n![](analysis_human-rights_files/figure-html/unnamed-chunk-11-1.png){fig-align='center' width=80%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nplot_trank(m_human_rights$model[[3]], params_to_show)\n```\n\n::: {.cell-output-display}\n![](analysis_human-rights_files/figure-html/unnamed-chunk-12-1.png){fig-align='center' width=80%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nplot_pp(m_human_rights$model[[3]])\n```\n\n::: {.cell-output-display}\n![](analysis_human-rights_files/figure-html/unnamed-chunk-13-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n### Abusive Enforcement\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nplot_trace(m_human_rights$model[[4]], params_to_show)\n```\n\n::: {.cell-output-display}\n![](analysis_human-rights_files/figure-html/unnamed-chunk-14-1.png){fig-align='center' width=80%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nplot_trank(m_human_rights$model[[4]], params_to_show)\n```\n\n::: {.cell-output-display}\n![](analysis_human-rights_files/figure-html/unnamed-chunk-15-1.png){fig-align='center' width=80%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nplot_pp(m_human_rights$model[[4]])\n```\n\n::: {.cell-output-display}\n![](analysis_human-rights_files/figure-html/unnamed-chunk-16-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n:::\n\n\n# Interpretation and marginal effects\n\n## Predictions\n\n::: {.column-page-right}\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nhuman_rights_plots <- human_rights_plot_data %>% \n  # Predicted probabilities\n  mutate(pred_plot = pmap(list(pred_data, nice, family), \\(.data, .nice_name, .family) {\n    if (.family == \"cumulative\") {\n      .data %>% \n        ggplot(aes(\n          x = year_week_day, y = .epred, ymin = .lower, ymax = .upper,\n          color = .category, fill = after_scale(color),\n          group = forcats::fct_rev(ordered(.width))\n        )) +\n        geom_lineribbon(alpha = 0.3) +\n        scale_color_manual(values = c(clrs[c(2, 4, 6, 7)])) +\n        scale_x_date(date_breaks = \"2 months\", date_labels = \"%b\\n%Y\") +\n        scale_y_continuous(labels = label_percent()) +\n        labs(x = NULL, y = \"Predicted probability\", \n             color = \"Severity\", fill = \"Severity\",\n             title = .nice_name) +\n        facet_wrap(vars(derogation_ineffect)) +\n        theme_pandem()\n    } else {\n      .data %>% \n        ggplot(aes(\n          x = year_week_day, y = .epred, ymin = .lower, ymax = .upper,\n          color = derogation_ineffect, fill = after_scale(color),\n          group = forcats::fct_rev(ordered(.width))\n        )) +\n        geom_lineribbon(alpha = 0.3) +\n        scale_color_manual(values = c(clrs[1], clrs[8])) +\n        scale_x_date(date_breaks = \"2 months\", date_labels = \"%b\\n%Y\") +\n        scale_y_continuous(labels = label_percent()) +\n        labs(x = NULL, y = \"Predicted probability\", \n             color = \"Derogation in effect\", fill = \"Derogation in effect\",\n             title = .nice_name) +\n        theme_pandem()\n    }\n  })) %>% \n  # Marginal effects / contrasts\n  mutate(mfx_plot = pmap(list(mfx_data, nice, family), \\(.data, .nice_name, .family) {\n    if (.family == \"cumulative\") {\n      .data %>% \n        mutate(across(c(draw, .lower, .upper), ~ . * 100)) %>%\n        ggplot(aes(\n          x = year_week_day, y = draw, ymin = .lower, ymax = .upper,\n          color = group, fill = after_scale(color),\n          group = forcats::fct_rev(ordered(.width))\n        )) +\n        geom_lineribbon(alpha = 0.3) +\n        geom_hline(yintercept = 0, linewidth = 0.5, color = \"grey50\") +\n        scale_color_manual(values = darken(clrs[c(2, 4, 6, 7)], 0.5, space = \"combined\"), guide = \"none\") +\n        scale_x_date(date_breaks = \"2 months\", date_labels = \"%b\\n%Y\") +\n        labs(x = NULL,\n             y = \"Percentage point difference\\nin probability of outcome level\",\n             title = .nice_name) +\n        facet_wrap(vars(group), ncol = 2) +\n        theme_pandem()\n    } else {\n      .data %>% \n        mutate(across(c(draw, .lower, .upper), ~ . * 100)) %>%\n        ggplot(aes(\n          x = year_week_day, y = draw, ymin = .lower, ymax = .upper,\n          group = forcats::fct_rev(ordered(.width))\n        )) +\n        geom_lineribbon(alpha = 0.3, fill = clrs[5], color = clrs[5]) +\n        geom_hline(yintercept = 0, linewidth = 0.5, color = \"grey50\") +\n        scale_x_date(date_breaks = \"2 months\", date_labels = \"%b\\n%Y\") +\n        labs(x = NULL,\n             y = \"Percentage point difference\\nin probability of outcome\",\n             title = .nice_name) +\n        theme_pandem()\n    }\n  }))\n\nwrap_plots(human_rights_plots$pred_plot)\n```\n\n::: {.cell-output-display}\n![](analysis_human-rights_files/figure-html/unnamed-chunk-17-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n:::\n\n::: {.column-page-right}\n\n## Marginal effects\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nwrap_plots(human_rights_plots$mfx_plot)\n```\n\n::: {.cell-output-display}\n![](analysis_human-rights_files/figure-html/unnamed-chunk-18-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}